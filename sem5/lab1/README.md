## Некоторые вопросы к защите

### Что находится по адресу 40h?

Область данных BIOS.

### Зачем мы в ES заносим 0? Что там расположено?

По 0 адресу распологается таблица веторов прерываний IDT.

### В чём смысл последовательности вызовов 1Ch - sub_1 - EOI

Смысл в том, что так как у нас приоритет у INT 8h высокий и оно вызывается очень часто (18.2 в секунду) нам важно, чтобы флаги не наложились друг на друга (т.е. чтобы не вызывался один iret во время работы второго).

### Для чего сбрасывается контроллер прервывания?

Чтобы позволить прерываниям меньшего приоритета обрабатываться.

### Как по научному называются 4 push в конце прерывания?

Сохранение аппаратного контекста.

### Как получили адрес обработчика прерывания?

Таблица векторов прерываний (IDT) в DOS расположена по нулевому адресу. Зная номер прерывания, можно получить смещение в этой таблице, по которому расположен дальний (far) адрес обработчика прерывания. Размер дальнего адреса - 4 байта (2 на сегмент и 2 на смещение). Например, для 8 прерывания смещение = 8 * 4 = 32. Надо иметь в виду, что в x86 используется обратный порядок записи байтов (little endian), поэтому если таблица векторов прерываний получена в виде массива байтов, то для получения шестнадцатеричного адреса необходимо перевернуть расположенные по найденному смещению 4 байта.

### Как называется такое действие в системе как отключение моторчика дисковода?

Отложенное действие, диску требуется время, приводит к временным затратам.

### Как получить реальное время, если известен адрес, по которому хранится число тиков с момента старта системы?

Поделить число тиков на 18.2 - получим время в миллисекундах. (делим на 1000 получаем секунды, делим на 60 получаем минуты).

### Как называется команда call dword ptr es:[70h]

Косвенный вызов.

### Что находится внутри обработчика прерывания 1Ch?

Это заглушка, внутри просто iret.

### Почему в коде декремента счетчика задержки отключения моторчика дисковода нет проверки, что в счетчике 0?

Чтобы не выполнять лишние операции (для быстродействия).

### Что такое маскируемые и не маскируемые прерывания?

Маскируемые вызываются по маске - соответственно вызов таких прерываний можно запретить. Не маскируемые запретить нельзя, такими могут быть ошибки различные.

### По какой шине передается маска маскируемого прерывания? 

По шине данных, так как маска является данным.

### Что значит каждая из колонок листинга?
(слева - направо) адреса (сегмент-смещение!), машинный код, команды ассемблера, комментарии.

### Что за флаг IF?

Interrupt flag - флаг прерывания - 1=разрешено, 0=запрещено.

### Зачем нужно прерывание 1Ch, если есть 8h?

1Ch – программное прерывание, а 8h — аппаратное. Если изменять код аппаратного, оно будет выполняться долго, а так как в doc у int8h самый высокий приоритет, то все процессорное время будет занято выполнением кода int8h.

### Что это за адрес - 0040:0314h ?

Область данных биос, там содержится копия флагов.

### Что делает префиксная команда lock?

Указывает на то, что следующее за ней команда должна выполняться, как неделимая. Прервать выполнение след за lock команды нельзя. Технически это осуществляется блокировкой локальной шины памяти. На время выполнения команды блокируется локальная шина памяти.

### Почему lock перед and?

Связано с особенностью работы and, операция объёмная и требует много времени.